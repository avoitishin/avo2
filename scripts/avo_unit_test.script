--[[-- INFO -------------------------------------------------------------------
	File				: avo_unit_test
	Description	: Unit tests for avo modules. Has to be run from loaded game, using avo_debug_mod.sandbox for example
	Credits			: aVo
	Revision		: 0.1
	Change Date	: 08.05.2014
--]] --------------------------------------------------------------------------

--[[-- TODO -------------------------------------------------------------------
	1. Implement tests
--]]---------------------------------------------------------------------------

--/----------------------------------------------------------------------------
--/ Variables & Constants
--/----------------------------------------------------------------------------
local SELF_NAME = script_name()

--/----------------------------------------------------------------------------
--/ Initialization
--/----------------------------------------------------------------------------
function _init()
	local CFG_FILE = avo.MOD_FOLDER..SELF_NAME..".ltx"
	local ini = ini_file(CFG_FILE)
	
	slot("avo_storage_ready", this.on_avo_storage_ready)
	
	ini = nil
	wlog("%s is ready", SELF_NAME)
end

--/----------------------------------------------------------------------------
--/ Callbacks
--/----------------------------------------------------------------------------
function on_avo_storage_ready()
	storage_test_load() -- loading stage of storage test
end

--/----------------------------------------------------------------------------
--/ avo_log unit tests
--/----------------------------------------------------------------------------

--/----------------------------------------------------------------------------
--/ avo_ini unit tests
--/----------------------------------------------------------------------------

--/----------------------------------------------------------------------------
--/ avo_lua unit tests
--/----------------------------------------------------------------------------

--/----------------------------------------------------------------------------
--/ avo_signals unit tests
--/----------------------------------------------------------------------------

--/----------------------------------------------------------------------------
--/ avo_netpk unit tests
--/----------------------------------------------------------------------------

--/----------------------------------------------------------------------------
--/ avo_storage unit tests
--/----------------------------------------------------------------------------
function storage_test()
	-- slot("avo_storage_ready", this.on_avo_storage_ready)
	local t = {["one"] = 1, ["two"] = "blah-blah", ["three"] = 2345.97774, [4] = "four"}
	local s = avo.save('storage_unit_test', t)
	ASSERT(avo.storage, "Storage unit test FAILED avo.storage does not exist")
	ASSERT(s, "Storage unit test FAILED at saving variable step")
	get_console():execute("save avo_storage_unit_test")
	get_console():execute("load avo_storage_unit_test")
end
function storage_test_load()
	local t = avo.load('storage_unit_test', {})
	ASSERT(table.size(t) == 4, "Storage unit test FAILED at loading variable step")
	dlog("Storage unit test PASSED")
end

--/----------------------------------------------------------------------------
--/ avo_timers_quick unit tests
--/----------------------------------------------------------------------------

--/----------------------------------------------------------------------------
--/ avo_timers_savable unit tests
--/----------------------------------------------------------------------------

--/----------------------------------------------------------------------------
--/ avo_utils unit tests
--/----------------------------------------------------------------------------

--/----------------------------------------------------------------------------
--/ avo_controller unit tests
--/----------------------------------------------------------------------------